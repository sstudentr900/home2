<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/customPrism.css">
    <link rel="stylesheet" href="../css/prism.css">
    <script src="../js/prism.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  </head>
  <body id="program">
    <script>
        const embedApiKey = 'AIzaSyBjQzpKIdXs5vEoOCh2vLj-8sF4XdXjnfI';
        //https://sheets.googleapis.com/v4/spreadsheets/{表單id}/values/{表單名稱}?alt=json&key={API金鑰}
        const uri = 'https://sheets.googleapis.com/v4/spreadsheets/13fLPsJrjKANkrStkhh1NKOwrdQ61SEafX1OTUFyBuTs/values/Sheet1?alt=json&key=' + embedApiKey;
        fetch(uri)
        .then(res=>res.json())
        .then(data=>{
          
          const values= data.values;
          console.log('get json:');
          console.log(values);
          let items = [];
          for(var i in values) {
            if(i>0){
              let item = {};
              item[values[0][0]] = values[i][0];
              item[values[0][1]] = values[i][1];
              items.push(item);
            }
          }
          console.log('try object:');
          console.log(items);
          console.table(items);

          //亂數
          // let r = () => {
          //   max = items.length - 1;
          //   min = 0;
          //   return Math.floor(Math.random() * (max - min + 1)) + min;
          // };
          // console.log('亂數:');
          // console.log();
        })
    </script>
    <h2>1.GCP新增新專案</h2>
    <p>
      進到
      <a href="https://console.cloud.google.com/welcome?project=constant-disk-141915&hl=zh-TW">Google Cloud Platform</a>
      的頁面按下新增專案，取好專案名稱後即可新增。
    </p>
    <h2>2.開通 Google Sheets API 功能</h2>
    <p>
      有了 GCP 的專案後，進到 API 程式庫：
      <a href="https://console.cloud.google.com/apis/library?hl=zh-TW">Google Cloud Platform</a>
      搜尋欄中搜尋「sheet」，會看到一項「Google Sheets API」：
    </p>
    <img src="https://i0.wp.com/i.imgur.com/MKOgxE2.png?w=840&ssl=1" alt="">
    <p>點擊後按下「啟用」，專案就會開通 Google Sheets API 的功能：</p>
    <img src="https://i0.wp.com/i.imgur.com/MbCk5V7.png?w=840&ssl=1" alt="">
    <h2>3.建立憑證</h2>
    <a href="https://console.cloud.google.com/apis/credentials/wizard?hl=zh-TW">網址</a>
    <img src="https://i0.wp.com/i.imgur.com/f9BITJH.png?w=840&ssl=1" alt="">
    <h2>4.建立 API 金鑰</h2>
    <img src="https://i0.wp.com/i.imgur.com/1Oey3Ae.png?w=840&ssl=1" alt="">
    <p>取得API 金鑰</p>
    <img src="https://i0.wp.com/i.imgur.com/oiTe1eb.png?w=840&ssl=1" alt="">
    <h2>Google Sheets URL</h2>
    <ul>
      <li>{表單id} 表單網址(../d/{表單id}/..)</li>
      <li>{表單名稱} 試算表的名稱</li>
    </ul>
    <pre class="prettyprint">
      <xmp>
        https://sheets.googleapis.com/v4/spreadsheets/{表單id}/values/{表單名稱}?alt=json&key={API金鑰}
      </xmp>
    </pre>
    <h2>範例:</h2>
    <pre class="prettyprint">
      <xmp>
        https://sheets.googleapis.com/v4/spreadsheets/{表單id}/values/{表單名稱}?alt=json&key={API金鑰}
      </xmp>
    </pre>
    <hr>
    <h4>參考</h4>
    <ul>
      <li>
        <a href="https://www.letswrite.tw/gas-google-sheet/" target="_blank">取得 Google Sheets / Excel 資料</a>
      </li>
      <li>
        <a href="https://www.letswrite.tw/google-excel-db/" target="_blank">Google Sheets / Excel 當作資料庫</a>
      </li>
    </ul>
  </body>
</html>
